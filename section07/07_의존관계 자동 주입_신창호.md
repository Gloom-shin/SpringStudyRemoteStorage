
# 스프링의 강의 리뷰📽
> LoadMap Part : 스프링 핵심원리 - 기본편   
> Section : 07.의존관계 자동 주입    
> CreateDate : 2022.06.18   
> UpdateDate : 2022.06.

### 목차
 - [다양한 의존관계 주입 방법](#1.다양한-의존관계-주입-방법)
 - [옵션 처리](#2.옵션-처리)
 - 생성자 주입을 선택해라
 - Lombok과 트랜드 
 - 조회 빈이 2개 이상 - 문제
 - @Autowired 필드명, @Quailifier , @Primary
 - 애노테이션 직접만들기
 - 조회한 빈이 모두 필요할 때, List, Map
 - 자동, 수동의 올바른 실무 운영 기준

<br></br>

# 1.다양한 의존관계 주입 방법
의존관계 주입은 크게 4가지 방법이 있다.
  - [생성자 주입](#생성자-주입)
  - [수정자 주입(setter 주입)](#수정자-주입)
  - 필드 주입
  - 일반 메서드 주입

## 생성자 주입
 - 이름 그대로 생성자를 통해서 의존 관계를 주입 받는 방법이다.
### 특징

- 생성자 호출시점에 딱 1번만 호출되는 것이 보장된다.
- 주로 불변이면서 필수 의존관계에 사용한다.
> 배우를 한번 정하고, 바꾸지 않을 경우 
```java
@Component
public class OrderServiceImpl implements OrderService {
     private final MemberRepository memberRepository;
     private final DiscountPolicy discountPolicy;
     
     @Autowired // 생략가능!
     public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
         this.memberRepository = memberRepository;
         this.discountPolicy = discountPolicy;
     }
}
```
- 중요! 생성자가 딱 1개만 있으면 @Autowired를 생략해도 자동 주입 된다. 물론 스프링 빈에만 해당한다

## 수정자 
 - setter라 불리는 필드의 값을 변경하는 수정자 메서드를 통해서 의존관계를 주입하는 방법이다.

### 특징
 - 선택, 변경 가능성이 있는 의존관계에 사용한다.
 - 자바빈 프로퍼티 규약의 수정자 메서드 방식을 사용하는 방법이다.
> 배우를 한번 정해놨지만, 의도적으로 대체할 수 있다.
 - `@Autowired` 의 기본 동작은 주입할 대상이 없으면 오류가 발생한다. 
   - 주입할 대상이 없어도 동작하게 하려면 `@Autowired(required = false)` 로 지정하면 된다
 - 요새는 많이 쓰이는 추세는 아니다.
```java
    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        System.out.println("memberRepository = " + memberRepository);
        this.memberRepository = memberRepository;
    }
    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        System.out.println("discountPolicy = " + discountPolicy);
        this.discountPolicy = discountPolicy;
    }

```

### 생성자 주입과 수정자 주입 차이
스프링에서 빈을 관리할 때 크게 2가지 과정을 거쳐 생성된다. 
  1. 빈을 생성한다. 
  2. 의존관계를 주입한다.

<p align="center"><img src="https://user-images.githubusercontent.com/104331549/174520626-e838fe2c-272b-4839-8064-1df4714ba389.png" width="50%"></p>
 
 - 생성자 주입의 경우, 빈 등록단계에서 인스턴스를 받아 바로 의존관계가 주입되는 단계에서 빈이 생성된다.
   - 그래서, 초기값이 인스턴스가 들어가 있다.
 - 수정자 주입의 경우, 빈 등록단계에서는 객체 생성시, 아무것도 없기 때문에 일단 `null`로 채워진채로 빈이 생성된다.

<p align="center"><img src="https://user-images.githubusercontent.com/104331549/174520643-2dd3d89d-adc0-45ee-9172-1f8c18a14086.png" width="50%"></p>
 
 - 생성자 주입의 경우, 이미 의존관계가 주입되어서 별도의 주입이 필요가 없다.
 - 수정자 주입의 경우 의존관계 주입이 시작된다.
   - `setter()`로 인해 `null`값이 아닌 다른 객체들로 주입해 줄 수가 있다. 
   - 값이 변경되야 하기때문에, `field`의 값이 `final`이면 안된다.
   
> 자바빈 프로퍼티
 - 특정 형태의 클래스를 가르키는 뜻이다. 
 - 필드는 private로 구성되고, getter/setter를 통해서만 접근할 수 있다. 
 - 전달 인자가 없는 생성자를 가지는 형태의 클래스이다. 
 - 참고 링크 
   - [okky 커뮤니티](https://okky.kr/article/509044)  
   - [velog 블로그](https://velog.io/@damiano1027/Spring-Java-Bean-Spring-Bean)

## 필드 주입
- 이름 그대로 필드에 바로 주입하는 방법이다.
- 필드의 접근제어자가 `private`이어도 가능하다.

### 특징
 - 코드가 간결해서 언뜻 보기엔 좋은 코드처럼 보이지만, 외부에서 변경이 불가능하다. 
   - 이말은, 임의의 더미 데이터를 만들 수 없다는 것을 뜻하며, 테스트하기 힘들다는 치명적인 단점이 생기는 것이다. 
   - 물론, `setter`를 만들어 테스트를 할 수 있지만, 그럼 애초에 수정자 주입으로 해주면 된다.
 - DI 프레임워크가 없으면 아무것도 할 수 없다.
 - 스프링 프레임워크도 추천하지 않는다.
 - 보통 테스트코드에서, 필드에 @Autowired를 사용한다.
 - 혹은 스프링 설정을 목적으로 하는 @Configuration 같은 곳에서만 특별한 용도로 사용

```java
    @Autowired private MemberRepository memberRepository;
    @Autowired private DiscountPolicy discountPolicy;
```

## 일반메서드 주입
 - 일반 메서드를 통해서 주입할 수 있다.
### 특징
 - 한번에 여러 필드를 주입 받을 수 있다.
 - 일반적으로 잘 사용하지 않는다.
   - 왠만해선 생성자 주입 혹은 수정자 주입으로 처리하기에, 일반메서드 주입은 잘 사용하지않는다.

 <br></br>
 <br></br>

# 2.옵션 처리


## 느낀점 😌

### 참고 링크

